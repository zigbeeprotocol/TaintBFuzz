[kernel] Parsing annotations.i (no preprocessing)
/* Generated by Frama-C */
/*@ axiomatic A {
      predicate P(ℤ x) 
        reads \nothing;
      
      }
 */
/*@ ghost int global_decl; */
/*@ ghost int global_def = 42; */
/*@ requires P(x) ∧ x > 0;
    ensures P(\old(x)); */
void function_no_ghost(int x)
{
  int y = 0;
  /*@ loop invariant 0 ≤ y ≤ x;
      loop assigns y;
      loop variant x - y; */
  while (y < x) {
    /*@ assert y < x; */ ;
    y ++;
    /*@ assert y ≤ x; */ ;
  }
  /*@ assert y ≡ x; */ ;
  /*@ requires y ≡ x;
      ensures y ≢ x;
      assigns y; */
  {
    y --;
    y *= 2;
  }
  /*@ requires y ≥ 0; */
  y /= y;
  return;
}

/*@ requires P(x) ∧ x > 0;
    ensures P(\old(x)); */
void function_with_ghost(int x)
{
  /*@ ghost int y = 0; */
  /*@ ghost
    /@ loop invariant 0 ≤ y ≤ x;
       loop assigns y;
       loop variant x - y; @/
    while (y < x) {
      /@ assert y < x; @/
      ;
      y ++;
      /@ assert y ≤ x; @/
      ;
    }
  */
  /*@ assert y ≡ x; */ ;
  /*@ ghost
    /@ requires y ≡ x;
       ensures y ≢ x;
       assigns y; @/
    {
      y --;
      y *= 2;
    }
  */
  /*@ ghost /@ requires y ≥ 0; @/
    y /= y; */
  return;
}

/*@ ghost
  /@ requires P(x) ∧ x > 0;
     ensures P(\old(x)); @/
  void ghost_function(int x)
  {
    int y = 0;
    /@ loop invariant 0 ≤ y ≤ x;
       loop assigns y;
       loop variant x - y; @/
    while (y < x) {
      /@ assert y < x; @/
      ;
      y ++;
      /@ assert y ≤ x; @/
      ;
    }
    /@ assert y ≡ x; @/
    ;
    /@ requires y ≡ x;
       ensures y ≢ x;
       assigns y; @/
    {
      y --;
      y *= 2;
    }
    /@ requires y ≥ 0; @/
    y /= y;
    return;
  }

*/

/*@ ghost
/@ requires variable > 0;
   assigns \nothing; @/
void function_declaration(int variable); */

void reference_function(void)
{
  /*@ ghost function_declaration(42); */
  return;
}


[kernel] Parsing ocode_annotations.c (with preprocessing)
[kernel] Parsing annotations.i (no preprocessing)
[kernel] annotations.i:13: Warning: 
  def'n of func function_no_ghost at annotations.i:13 (sum 9297192) conflicts with the one at ocode_annotations.c:12 (sum 14988159); keeping the one at ocode_annotations.c:12.
[kernel] annotations.i:43: Warning: 
  def'n of func function_with_ghost at annotations.i:43 (sum 9297192) conflicts with the one at ocode_annotations.c:38 (sum 14988159); keeping the one at ocode_annotations.c:38.
[kernel] annotations.i:80: Warning: 
  def'n of func ghost_function at annotations.i:80 (sum 9297192) conflicts with the one at ocode_annotations.c:71 (sum 14988159); keeping the one at ocode_annotations.c:71.
[kernel] annotations.i:114: Warning: 
  dropping duplicate def'n of func reference_function at annotations.i:114 in favor of that at ocode_annotations.c:105
/* Generated by Frama-C */
/*@ axiomatic A {
      predicate P(ℤ x) 
        reads \nothing;
      
      }
 */
/*@ ghost int global_decl; */
/*@ ghost int global_def = 42; */
/*@ requires P(x) ∧ x > 0;
    ensures P(\old(x)); */
void function_no_ghost(int x)
{
  int y = 0;
  /*@ loop invariant 0 ≤ y ≤ x;
      loop assigns y;
      loop variant x - y; */
  while (y < x) {
    /*@ assert y < x; */ ;
    y ++;
    /*@ assert y ≤ x; */ ;
  }
  /*@ assert y ≡ x; */ ;
  /*@ requires y ≡ x;
      ensures y ≢ x;
      assigns y; */
  {
    y --;
    y *= 2;
  }
  /*@ requires y ≥ 0; */
  y /= y;
  return;
}

/*@ requires P(x) ∧ x > 0;
    ensures P(\old(x)); */
void function_with_ghost(int x)
{
  /*@ ghost int y = 0; */
  /*@ ghost
    /@ loop invariant 0 ≤ y ≤ x;
       loop assigns y;
       loop variant x - y; @/
    while (y < x) {
      /@ assert y < x; @/
      ;
      y ++;
      /@ assert y ≤ x; @/
      ;
    }
  */
  /*@ assert y ≡ x; */ ;
  /*@ ghost
    /@ requires y ≡ x;
       ensures y ≢ x;
       assigns y; @/
    {
      y --;
      y *= 2;
    }
  */
  /*@ ghost /@ requires y ≥ 0; @/
    y /= y; */
  return;
}

/*@ ghost
  /@ requires P(x) ∧ x > 0;
     ensures P(\old(x)); @/
  void ghost_function(int x)
  {
    int y = 0;
    /@ loop invariant 0 ≤ y ≤ x;
       loop assigns y;
       loop variant x - y; @/
    while (y < x) {
      /@ assert y < x; @/
      ;
      y ++;
      /@ assert y ≤ x; @/
      ;
    }
    /@ assert y ≡ x; @/
    ;
    /@ requires y ≡ x;
       ensures y ≢ x;
       assigns y; @/
    {
      y --;
      y *= 2;
    }
    /@ requires y ≥ 0; @/
    y /= y;
    return;
  }

*/

/*@ ghost
/@ requires variable > 0;
   assigns \nothing; @/
void function_declaration(int variable); */

void reference_function(void)
{
  /*@ ghost function_declaration(42); */
  return;
}


